<h1>Listing All Jobs</h1>

<table class="table table-bordered table-hover">
	<thead>
		<tr>
			<th>Title</th>
			<th>Dept</th>
			<th>Hire Num</th>
			<th>Create Date</th>
			<% if can? :update, Jobapp %>
				<th>#Apply</th>
			<% end %>
			<th colspan="3">Action</th>
		</tr>
	</thead>

	<tbody>
		<% @jobapps.each do |jobapp| %>
		<tr>
			<td><%= link_to jobapp.title, jobapp %></td>
			<td><%= jobapp.dept %></td>
			<td><%= jobapp.num %></td>
			<td><%= jobapp.created_at %></td>
			<% if can? :update, jobapp %>
			<td>
				
				<%= jobapp.users.count %>
			</td>
			<% end %>
			<td>
					<% if !current_user.recruiter? && !current_user.applying?(jobapp) %>
					    <%= link_to 'Apply', jobapp %>
					 <% end %>
					<% if !current_user.recruiter? && current_user.applying?(jobapp) %>
					    <p style="color:red">
					    	Applied!
					    </p>
					<% end %>
					
					<% if can? :update, jobapp %>
						<%= link_to 'Edit', edit_jobapp_path(jobapp) %>
					<% end %>
					<% if can? :destroy, jobapp %>
						<%= link_to 'Destroy', jobapp, method: :delete, data: { confirm: 'Are you sure?' } %>
					<% end %>
			</td>
		</tr>
		<% end %>
	</tbody>
</table>

<br>

<% if can? :new, Jobapp%>
	<ul class="pager">
		<li>
			<%= link_to 'New Job', new_jobapp_path %>
		</li>
	</ul>
<% end %>
